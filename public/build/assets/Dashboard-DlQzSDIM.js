import{d as B,n as M,c as s,r as v,a as _,o as f,b as l,u as n,m as S,w as V,e as t,f as g,v as D,g as E,h as F,F as N,W as P}from"./app-CqK4TCx6.js";import{_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-CCa1DBPj.js";import{C as U,p as W,a as j,b as q,L as A,B as O,c as T,d as $,P as z,e as u,f as G}from"./index-CiJ2fszI.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang--Ej3HdsY.js";import"./useForwardExpose-C1_6ugm9.js";import"./RovingFocusGroup-DwJBTnNb.js";const H={class:"p-6 space-y-6"},I={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},J={class:"grid md:grid-cols-2 gap-6"},K={class:"h-[400px] rounded-xl border p-4 shadow-sm"},Q={class:"h-[400px] rounded-xl border p-4 shadow-sm"},X={class:"md:col-span-2 h-[400px] rounded-xl border p-4 shadow-sm"},Y={class:"h-[400px] rounded-xl border p-4 shadow-sm"},Z={class:"h-[400px] rounded-xl border p-4 shadow-sm"},ee={class:"text-center"},de=B({__name:"Dashboard",setup(ae){U.register(W,j,q,A,O,T,$,z);const p=M(),b=s(()=>p.props.forecasts),h=s(()=>p.props.hasMore);v(p.props.limit);const m=v(""),r=v(20),o=s(()=>{const e=m.value.toLowerCase();return b.value.filter(a=>a.name.toLowerCase().includes(e)||a.article.toLowerCase().includes(e)).slice(0,r.value)}),x=()=>{r.value+=20,r.value>b.value.length&&h.value&&P.get("/dashboard",{limit:r.value},{preserveState:!0})},c=s(()=>o.value.map(e=>e.name.length>25?e.name.slice(0,25)+"…":e.name)),d=e=>({responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:e}},maintainAspectRatio:!1}),C=s(()=>({labels:c.value,datasets:[{label:"Остаток",data:o.value.map(e=>e.current_stock),backgroundColor:"#3b82f6"}]})),w=s(()=>({labels:c.value,datasets:[{label:"Прогноз",data:o.value.map(e=>e.forecast),backgroundColor:"#10b981"}]})),k=s(()=>({labels:c.value,datasets:[{label:"Остаток",data:o.value.map(e=>e.current_stock),borderColor:"#3b82f6",fill:!1,tension:.4},{label:"Прогноз",data:o.value.map(e=>e.forecast),borderColor:"#10b981",fill:!1,tension:.4}]})),y=s(()=>({labels:c.value,datasets:[{label:"Рекомендуемое пополнение",data:o.value.map(e=>e.forecast-e.current_stock),backgroundColor:"#f59e0b"}]})),L=s(()=>{const e=[...o.value].sort((a,i)=>a.current_stock-i.current_stock).slice(0,10);return{labels:e.map(a=>a.name.length>25?a.name.slice(0,25)+"…":a.name),datasets:[{label:"Топ 10 наименьших остатков",data:e.map(a=>a.current_stock),backgroundColor:"#ef4444"}]}});return(e,a)=>(f(),_(N,null,[l(n(S),{title:"Dashboard"}),l(R,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"}]},{default:V(()=>[t("div",H,[t("div",I,[g(t("input",{"onUpdate:modelValue":a[0]||(a[0]=i=>m.value=i),type:"text",placeholder:"Поиск по названию или артикулу",class:"w-full md:w-1/2 rounded-md border px-3 py-2"},null,512),[[D,m.value]]),g(t("select",{"onUpdate:modelValue":a[1]||(a[1]=i=>r.value=i),class:"rounded-md border px-3 py-2"},a[2]||(a[2]=[t("option",{value:10},"Показать 10",-1),t("option",{value:20},"Показать 20",-1),t("option",{value:50},"Показать 50",-1),t("option",{value:100},"Показать 100",-1),t("option",{value:9999},"Показать всё",-1)]),512),[[E,r.value]])]),t("div",J,[t("div",K,[l(n(u),{data:C.value,options:d("Остатки по товарам")},null,8,["data","options"])]),t("div",Q,[l(n(u),{data:w.value,options:d("Прогноз по товарам")},null,8,["data","options"])]),t("div",X,[l(n(G),{data:k.value,options:d("Остаток против прогноза")},null,8,["data","options"])]),t("div",Y,[l(n(u),{data:y.value,options:d("Рекомендуемое пополнение")},null,8,["data","options"])]),t("div",Z,[l(n(u),{data:L.value,options:d("Топ 10 наименьших остатков")},null,8,["data","options"])])]),t("div",ee,[h.value?(f(),_("button",{key:0,onClick:x,class:"mt-6 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 transition"}," Загрузить больше данных ")):F("",!0)])])]),_:1})],64))}});export{de as default};
